<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<script src="./libs/three.js"></script>
	<script src='./js/libs/stats.js'></script>
	<script src="./utils/config.js"></script>
	<script src="./utils/index.js"></script>
	<script src="./js/loaders/MTLLoader.js"></script>
	<script src="./js/controls/TransformControls.js"></script>
	<script src='./js/controls/DragControls.js'></script>
	<script src="./js/loaders/OBJLoader.js"></script>
	<script src="./js/utils/SceneUtils.js"></script>
	<script src="./assets/dat.gui.min.js"></script>
	<script src="./assets/d3-threeD.js"></script>
	<style>
		* {
			margin: 0;
			padding: 0
		}

	</style>
</head>

<body>
	<div id="batman" style="display:none;">

	</div>
	<div style="height:800px" id="app"></div>
	<script>
		var groups = [];
		var Dev = new DevThree({
			id: "app",
			camera: {
				position: {
					x: 300,
					y: 410,
					z: 380
				}
			},
			stats: true,
			transformControls: true,
			click: function (datas) {
				if (datas.length == 0) {
					return
				}
				// datas.forEach(x => {
				let obj = datas[0].object;
				if (obj.userData.type == 'path') {

					groups.forEach(node => {
						if (node.uuid == obj.uuid) {
							console.log(obj)
							node.position.y = 40
						} else {
							node.position.y = 20
						}
					})
				}
				// })
			},
			created({
				scene,
				DragMeshs
			}) {
				var light = new THREE.AmbientLight(0x404040); // soft white light
				scene.add(light);
				var light = new THREE.HemisphereLight(0xffffbb, 0x080820, 1);
				scene.add(light);


				/* var spotLight = new THREE.SpotLight( 0xffffff );
				spotLight.position.set( 10, 150, 10 );
				scene.add( spotLight );
 */
				/* var spotLightHelper = new THREE.SpotLightHelper( spotLight );
				spotLight.shadow.mapSize.width = 1024;
				spotLight.shadow.mapSize.height = 1024;

				spotLight.shadow.camera.near = 500;
				spotLight.shadow.camera.far = 4000;
				spotLight.shadow.camera.fov = 30;
				scene.add( spotLightHelper ); */
			 
			 

				new THREE.MTLLoader().load('./image/rvt.mtl', function (materials) {
					materials.preload();

					// instantiate a loader
					var loader = new THREE.OBJLoader().setMaterials(materials); 
					// load a resource
					loader.load(
						// resource URL
						'./image/rvt.obj',
						// called when resource is loaded
						function (object) {
							// object.rotation.x = -Math.PI / 2
							object.rotation.y = -Math.PI / 2
							object.scale.set(10,10,10)
							// object.position.y =30
						/* 	object.children.forEach(x => {
								if (x.material) {
									if (x.material.color) {
										x.material.color.r = 1
										x.material.color.g = 1
										x.material.color.b = 1
									} else { 
										if(Array.isArray(x.material)){
											x.material.forEach(m=>{
												m.color.r = 1
												m.color.g = 1
												m.color.b = 1
											})
										}
									}
								} else { 
									
								}
							}) */


							scene.add(object);
							console.log(object)
							// scene.add(object.children[0])
						},
						// called when loading is in progresses
						function (xhr) {

							console.log((xhr.loaded / xhr.total * 100) + '% loaded');

						},
						// called when loading has errors
						function (error) {

							console.log('An error happened');

						}
					);
				});


				/* }) */
			}
		})

	</script>
</body>

</html>
